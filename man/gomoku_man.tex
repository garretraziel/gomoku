\documentclass[a4paper,11pt,titlepage]{article}
\usepackage[czech]{babel}
\usepackage[utf8]{inputenc}
\pagestyle{headings}
\author{Jan Sedlák a Aleš Dujíček}
\title{Uživatelský manuál k programu Gomoku}
\frenchspacing
\begin{document}
\maketitle
\tableofcontents
\newpage
\section{Úvod}
Piškvorky je jedna z nejznámějších her, jejíž kořeny můžeme najít ve starověkém Japonsku. Již od pradávna se mnozí snaží najít co nejlepší výherní taktiku, programování umělé inteligence (AI) pro piškvorky patří po programování AI pro šachy mezi nejoblíbenější úlohy. 

Gomoku je aplikace pro hraní piškvorek, která obsahuje myší ovládané grafické prostředí pro hru proti jedné ze dvou AI, hru inteligencí proti sobě navzájem nebo hru člověka proti člověku. Program je napsán pro platformu Linux, ale návrh, struktura použitého jazyka a multiplatformní knihovna SDL zaručují úspěšnou kompilaci i pro jiné platformy (vč. MS Windows).

Tato dokumentace by měla sloužit jak pro jednodušší orientaci v GUI\footnote{grafické uživatelské rozhraní} programu, tak pro jednoduché vysvětlení principu fungování v tomto programu obsažených AI.

V sekci 1 se budeme zabývat hrou piškvorky, vysvětlením jejích pravidel a její stručné historii. V sekci 2 se budeme zabývat obsluhou grafického rozhraní programu Gomoku, v sekci 3 budeme popisovat fungování našich AI. V sekci 4 se podíváme na obecné styly řešení AI pro piškvorky. Sekce 5 je sekce programátorská, popíšeme si postup kompilace pro různé platformy. V této sekci také bude stručná charakteristika použitého jazyka a knihovny pro operace s grafikou.
\newpage
\section{O hře piškvorky}
\subsection{Pravidla}
Hra piškvorky je jednoduchá hra pro dva hráče. Hraje se za pomocí čtve\-reč\-ko\-va\-né jednobarevné šachovnice. Každý hráč má své tokeny (většinou křížky a kolečka). Cílem hry je umístit své tokeny na šachovnici tak, aby vodorovně, svisle či diagonálně vznikla neporušená přímá řada pěti hráčových tokenů. Hráči se v umisťování tokenů střídají. Povoleno je samozřejmě umisťování tokenů pouze na volná místa. První, kdo vytvoří neporušenou řadu pěti tokenů, vyhrává. 

Existuje samozřejmě několik taktik hry, rozumné je používat vlastní tokeny k blokování soupeřových řad. Častá je také snaha o vytvoření několika konkrétních kombinací, které hráče dostávají do výhodnější pozice.
\subsection{Historie}
Dnešní podoba piškvorek (angl. Tic-Tac-Toe či Five-in-a-row) se nejspíše vyvinula z oblíbené japonské hry gomoku. V japonském gomoku nejsou tokeny rozlišeny tvarem, ale barvou. Kladou se na křížení čar tvořících šachovnici. Oproti dnešním piškvorkám se dále liší pravidlem, zakazujícím vyhrát pomocí řady delší jak pět tokenů. Její kořeny sahají až k tradiční japonské hře Go, se kterou Gomoku sdílí nejen herní šachovnici (tzv. Goban), ale také některé charakteristiky.

V dnešních dobách vznikají snahy o vytvoření co nejlepšího algoritmu pro hraní piškvorek. Holandský programátor L. Victor Allis naprogramoval algoritmus, který na šachovnici 15*15 zajistí začínajícímu hráči výhru. Algoritmus však bohužel nebyl nikdy zveřejněn. Existují jednoduché matematické důkazy o tom, že na neomezené herní ploše musí existovat neprohrávající strategie pro začínajícího hráče.
\newpage
\section{Obsluha rozhraní programu Gomoku}
Program Gomoku má jednoduché GUI, ovládané myší a klávesnicí. Po spu\-ště\-ní programu (např. z konzole příkazem `./piskvorky' vyvolaného z adresáře, ve kterém se nachází program gomoku) se objeví jednoduché okno, ve kterém bude zobrazena prázdná herní šachovnice a dole ve stavovém řádku nápis `[F1] AIxAI, [F2] AI1, [F3] AI2, [F4] human x human'. Toto je jednoduché herní menu. Stisknutí příslušné klávesy vyvolá požadovanou akci: 
\begin{itemize} 
\item Stisknutím {\bf F1} se automaticky spustí hra umělé inteligence proti umělé inteligenci. 
\item Stisknutím {\bf F2} se spustí hra hráče proti první (jednodušší) AI. 
\item Stisknutím {\bf F3} se spustí hra proti druhé (těžší) AI. 
\item Stisknutím {\bf F4} začne hra hráče proti hráči.
\end{itemize}
Při hře AI vs. AI se po automatickém odehrání hra ukončí. Při hře hráče hráč umisťuje svoje tokeny pomocí myši, kliknutím na příslušné místo.

Pokud je ve hře na řadě hráč, může stisknout klávesy `q' pro ukončení hry nebo `r' pro restart hry.

Po ukončení hry se zobrazí ve stavovém řádku nápis `vyhraly krizky', `vyhrala kolecka', `hra byla ukoncena' popřípadě `remiza' a za tímto nápisem jednoduchá nabídka `[q]uit [r]estart [m]enu'. Pokud stisknete `q', ukončí se program Gomoku. Pokud stisknete `r', restartuje se právě ukončená hra. Po stisknutí `m' se dostanete zpět do hlavního herního menu.
\newpage
\section{Realizace a algoritmy našich AI}
\subsection{AI1}
Naše první umělá inteligence funguje na opravdu jednoduchých principech. Pro vlastní potřebu jsme ji pokřtili na metodu \uv{Franta hraje piškvorky}. Jedná se o spe\-ci\-fic\-kou od\-nož me\-to\-dy zva\-né \uv{Al\-go\-rit\-mus prohledávání do šířky - hloubky}. Umělá inteligence obsahuje funkci, která zjišťuje pro zadaný token posloupnost o zadané délce. Na začátku svého tahu zkopíruje celé herní pole, poté na každou volnou pozici dá svůj znak a zkontroluje, jestli se nejedná o výherní posloupnost (tím by vytvořila pětici a vyhrála). 

Pokud neexistuje žádné takové místo, které by vedlo k výherní posloupnosti, zopakuje totéž, nicméně s nepřítelovým tokenem. Dosazuje nepřítelův token a zkouší, jestli by nepřítel nemohl vyhrát. Pokud ano, zabrání výhře dosazením vlastního tokenu. Algoritmus se opakuje znovu, nejdříve pro za\-brá\-ně\-ní nepřítelových čtveřic, poté trojic a pak se už inteligence soustředí na tvoření co nejdelší vlastní posloupnosti. Jedná se částečně o brute-force metodu. Při hře AI1 nedochází k ohodnocování tahů.

AI1 je kratší a jednodušší inteligence, při soupeření s naší druhou inteligenci většinou prohrává. Mezi její výhody však patří \uv{pozornost} - AI1 nemůže udělat chybu špatným ohodnocením políčka díky špatně nastavené prioritě (v konečném důsledku nevznikne situace kdy není jasné, proč AI1 položilo token na pozici na kterou ho položilo). Jedná se také o transparentnější AI.
\subsection{AI2}
\section{Obecné algoritmy AI pro piškvorky}
\newpage
\section{Struktura a člěnění zdrojových kódů, kompilace}
\subsection{O použitém jazyce a grafické knihovně SDL}
Program byl napsán za pomocí programovacího jazyka C a knihovny poskytující grafické rozhraní SDL. Programovací jazyk C je jeden z nej\-ob\-lí\-be\-něj\-ších a nejrozšířenějších programovacích jazyků. Používá se pro programování operačních systému i aplikací. Program Gomoku byl kompilován C kompilerem GCC (který je šířen pod svobodnou licencí GNU/GPL). Používá také svobodnou grafickou knihovnu SDL, která byla vyvinuta pro programování počítačových her. SDL poskytuje funkce pro grafický výstup programu a také rozhraní pro používání myši a klávesnice.
\subsection{Kompilace}
Kompilace (čili překlad zdrojových kódů do výsledného binárního spustitelného souboru) se liší použitím různých kompilerů či různých platforem. Postup pro kompilaci pro Linux je následující: z repozitářů stáhněte balíky obsahující knihovnu SDL, knihovnu SDL\_gfx a jejich developer verze (obsahují hlavičkové soubory, většinou označené příponou -devel), C kompiler (například GCC) a pro snadnější kompilaci program make. Kompilaci proveďte jednoduše z terminálu, kdy ve složce se zdrojovými kódy napíšete příkaz `make'. 

Pro MS Windows je potřeba stáhnout některé IDE (například DEV-C++), dále knihovny SDL a SDL\_gfx (možno je i dané knihovny přímo zkompilovat) a poté postupovat jako při kompilaci jakéhokoliv jiného projektu v daném IDE.
\subsection{Struktura a rozčlenění programu}
Zdrojový kód programu Gomoku je zcela v souladu s principy programování v jazyce C rozčleněn do několika souborů, podle typů funkcí v něm ob\-sa\-že\-ných. Hlavní program je uložen v souboru main.c. Zde se provádí nejnutnější volání funkcí programu, základní obsluha knihovny SDL a volání fcí jednotlivých hráčů nebo inteligencí. Hlavičkové soubory ai1.h, ai2.h a k nim náležící soubory se zdrojovým kódem obsahují funkce jednotlivých umělých inteligencí. Funkce obsluhující grafickou část programu jsou obsaženy v souborech graphics.c a graphics.h. V souboru human.c a .h je obsaženo rozhraní pro ovládání hry člověkem. Soubory game.c a .h obsahují herní mechanizmy (např. kontrolu výhry). A konečně soubor defines.h obsahují základní konstanty, jako například konstanty reprezentující velikost herního pole, konstanty reprezentující jednotlivé tokeny a podobně.
\section{Licence}
Licenci programu Gomoku můžete najít v souboru LICENCE, který by měl být distribuován zároveň se zdrojovými kódy programu.

(g) 2010 Jan Sedlák a Aleš Dujíček. Vysázeno pomocí programu \LaTeX
\end{document}